<!DOCTYPE html>
<html lang="en">
  <head>
    <meta
      http-equiv="Content-Type"
      content="text/html;
charset=UTF-8"
    />
    <title>Assignment</title>
    <style type="text/css">
      body {
        font-family: "HelveticaNeue-Light", sans-serif;
        padding: 15px;
      }
    </style>
    <script src="../artistoo/build/artistoo.js"></script>
    <script>
      "use strict";

      document.addEventListener("click", function (event) {
        let canvas = document.querySelector("canvas");
        let rect = canvas.getBoundingClientRect();
        let x = event.clientX - rect.left;
        let y = event.clientY - rect.top;
        x = Math.floor((x / canvas.width) * sim.C.extents[0]);
        y = Math.floor((y / canvas.height) * sim.C.extents[1]);
        sim.gm.seedCellAt(2, [x, y]);
    });

      function initializeGrid() {
        //Grid of obstacles
        if (!this.helpClasses["gm"]) {
          this.addGridManipulator();
        }
        let step = 20;
        for (let i = 1; i < this.C.extents[0]; i += step) {
          for (let j = 1; j < this.C.extents[1]; j += step) {
            this.gm.seedCellAt(2, [i, j]);
          }
        }
        //Spawn 10 random cells
        for (let k = 0; k < 10; k++) {
          let x = Math.floor(Math.random() * this.C.extents[0]);
          let y = Math.floor(Math.random() * this.C.extents[1]);
          this.gm.seedCellAt(1, [x, y]);
        }
      }
    
      let sim;
      let config = {
        ndim: 2,
        field_size: [100, 100],
        conf: {
          T: 20,
          J: [
            [0, 20, 1000],
            [20, 0, 1000],
            [1000, 1000, 1000],
          ],
          LAMBDA_V: [0, 50, 1000],
          V: [0, 200, 100],
          LAMBDA_P: [0, 2, 2],
          P: [0, 180, 0],
          MAX_ACT: [0, 50, 0],
          ACT_MEAN: "geometric",
          LAMBDA_ACT: [0, 200, 0],
        },

        simsettings: {
          CELLCOLOR: ["00FF00", "000000"],
          ACTCOLOR : [true,false],
          NRCELLS: [0, 0],
          RUNTIME: 500,
          CANVASCOLOR: "eaecef",
          zoom: 4,
        },
      };

      function init() {
        sim = new CPM.Simulation(config, { initializeGrid: initializeGrid });
        sim.run();
        step();
      }

      function step() {
        sim.step();
        requestAnimationFrame(step);
      }
    </script>
  </head>

  <body onload="init()">
    <h1>Assignment 1</h1>
  </body>
</html>
